name: 'RepoDynamics: Workflow Context'
author: 'Armin Ariamajd'
description: 'Add workflow contexts to GitHub Actions job summaries.'
branding:
  icon: file-text
  color: blue


runs:
  using: "composite"
  steps:

    - name: 'Setup Python'
      uses: actions/setup-python@v4
      with:
        python-version: '3.x'

    - name: 'Install dependencies'
      run: pip install repodynamics[workflow_context]
      shell: bash

    - name: "Run"
      env:
        RD__WORKFLOW_CONTEXT__GITHUB: ${{ toJson(github) }}
        RD__WORKFLOW_CONTEXT__JOB: ${{ toJson(job) }}
        RD__WORKFLOW_CONTEXT__STEPS: ${{ toJson(steps) }}
        RD__WORKFLOW_CONTEXT__RUNNER: ${{ toJson(runner) }}
        RD__WORKFLOW_CONTEXT__STRATEGY: ${{ toJson(strategy) }}
        RD__WORKFLOW_CONTEXT__MATRIX: ${{ toJson(matrix) }}
      run: python -m repodynamics.actions workflow_context
      shell: bash
